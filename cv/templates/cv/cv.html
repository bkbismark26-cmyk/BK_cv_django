<!DOCTYPE html>
<html lang = "es">

<head>
    <meta charset = "UTF-8">

    <title> 
        {{ perfil.nnombres }} {{ perfil.apellidos }}
    </title>

    <!-- Bootstrap -->
    <link href = "https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel = "stylesheet">
    <link rel = "stylesheet" href = "https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background:
            radial-gradient(circle at 20% 20%, rgba(255,255,255,0.8), transparent 40%),
            radial-gradient(circle at 80% 10%, rgba(255,255,255,0.6), transparent 45%),
            radial-gradient(circle at 50% 90%, rgba(255,255,255,0.5), transparent 50%),
            linear-gradient(135deg, #0ea5e9, #e6faff);
            color: #0f172a;
            padding-top: 90px;
            scroll-behavior: smooth;
        }

        .perfil-img {
            width: 160px;
            height: 160px;
            object-fit: contain;
            border-radius: 50%;
            border: 4px solid #0f172a;
            background-color: #ffffff;
            padding: 5px;
        }

        .card {
            background-color: rgba(255, 255, 255, 0.95);
            border: none;
            border-radius: 16px;
        }

        h1 {
            font-weight: 700;
        }

        .section-title {
            font-weight: 600;
            border-left: 5px solid #d4af37;
            padding-left: 12px;
            margin-bottom: 20px;
        }

        .skill-chip {
            padding: 10px 16px;
            background-color: #0f172a;
            color: #ffffff;
            border-radius: 14px;
            font-size: 14px;
            font-weight: 500;
            box-shadow: 0 4px 10px rgba(37, 99, 235, 0.2);
            transition: 0.2s;
        }

        .skill-chip:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 18px rgba(37, 99, 235, 0.3);
        }

        /* ========== Modo obscuro ========== */
        body.dark-mode {
            background:
                radial-gradient(circle at 20% 20%, rgba(56,189,248,0.12), transparent 45%),
                radial-gradient(circle at 80% 10%, rgba(255,255,255,0.05), transparent 40%),
                radial-gradient(circle at 50% 90%, rgba(56,189,248,0.08), transparent 50%),
                linear-gradient(135deg, #020617, #020617);
            color: #e5e7eb;
        }

        body.dark-mode .navbar {
            background-color: #020617 !important;
        }

        body.dark-mode .card {
            background: rgba(2, 6, 23, 0.85);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(56,189,248,0.15);
            color: #e5e7eb;
            box-shadow:
                0 10px 30px rgba(0,0,0,0.6),
                inset 0 0 0 1px rgba(255,255,255,0.02);
        }

        body.dark-mode .section-title {
            border-left-color: #38bdf8;
            color: #e0f2fe;
            text-shadow: 0 0 6px rgba(56,189,248,0.35);
        }

        body.dark-mode .text-muted {
            color: #94a3b8 !important;
        }

        body.dark-mode .card:hover {
            transform: translateY(-6px);
            box-shadow:
                0 18px 45px rgba(56,189,248,0.25),
                0 0 25px rgba(56,189,248,0.2);
        }

        body.dark-mode .skill-chip {
            background-color: #0f172a;
        }

        body.dark-mode a {
            color: #ffffff;
        }

        /* ========== Evitar que la navbar tape las secciones ========== */
        section {
            scroll-margin-top: 90px;
        }

        /* ========== Modo obscuro para navbar ========== */
        body.dark-mode .navbar {
            background: rgba(2,6,23,0.85) !important;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(56,189,248,0.15);
        }

        body.dark-mode .navbar-brand,
        body.dark-mode .nav-link {
            color: #e5e7eb !important;
        }

        body.dark-mode .nav-link:hover,
        body.dark-mode .navbar-brand:hover {
            color: #38bdf8 !important;
            background-color: transparent !important;
        }

        /* ========== Fecha y texto legibles ========== */
        body.dark-mode .text-muted {
            color: #94a3b8 !important;
            opacity: 0.9;
        }

        /* ========== Modo obscuro para cards ========== */
        body.dark-mode .card {
            background: rgba(2, 6, 23, 0.82);
            backdrop-filter: blur(14px);
            color: #e5e7eb;
            border: 1px solid rgba(56,189,248,0.18);
            box-shadow:
                0 10px 35px rgba(0,0,0,0.7),
                inset 0 0 0 1px rgba(255,255,255,0.02);
        }

        /* ========== Certificados ========== */
        .cert-card:hover {
            transform: translateY(-6px);
            box-shadow:
                0 20px 45px rgba(56,189,248,0.25),
                0 0 25px rgba(56,189,248,0.18);
        }

        .cert-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.25);
        }

        .cert-title {
            font-weight: 600;
            font-size: 15px;
        }

        /* ========== Modo obscuro ========== */
        body.dark-mode .cert-card {
            background: rgba(2,6,23,0.9);
            border: 1px solid rgba(56,189,248,0.15);
        }

        body.dark-mode .modal-content {
            background: rgba(2,6,23,0.95);
            color: #e5e7eb;
            border: 1px solid rgba(56,189,248,0.15);
        }

        body.dark-mode .modal-header {
            border-bottom: 1px solid #1e293b;
        }

        body.dark-mode .btn-close {
            filter: invert(1);
            opacity: 0.9;
        }

        body.dark-mode .btn-close:hover {
            opacity: 1;
        }

        /* ========== Animaciones suaves (Hover) ========== */
        .card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
        }

        /* ========== Modo obscuro ========== */
        body.dark-mode .card:hover {
            transform: translateY(-6px);
            box-shadow:
                0 18px 45px rgba(56,189,248,0.28),
                0 0 30px rgba(56,189,248,0.22);
        }

        /* ========== Botones ========== */
        .btn {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }

        /* ========== Skill chips ========== */
        .skill-chip {
            transition: transform 0.25s ease, box-shadow 0.25s ease;
        }

        .skill-chip:hover {
            transform: translateY(-4px) scale(1.03);
        }

        /* ========== Scroll reveal ========== */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease;
        }

        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        body {
            transition:
                background-color 0.35s ease,
                color 0.35s ease;
        }

        a,
        button {
            transition:
                background-color 0.25s ease,
                color 0.25s ease,
                border-color 0.25s ease,
                transform 0.25s ease;
        }

        @media print {

             /* üî¥ OCULTAR SECCIONES DESMARCADAS EN PDF */
            .pdf-hide {
                display: none !important;
            }
            
            body {
                background: #ffffff !important;
                color: #111827 !important;
                font-family: 'Inter', sans-serif;
                line-height: 1.5;
                padding: 1cm;
            }

            nav, .dark-toggle, .btn { display: none !important; }

            .container {
                max-width: 100% !important;
                padding: 0 !important;
            }

            .card {
                box-shadow: 0 4px 15px rgba(0,0,0,0.08) !important;
                border-radius: 15px !important;
                margin-bottom: 20px;
                padding: 20px;
                border: 1px solid #e5e7eb;
            }

            section {
                opacity: 1 !important;
                transform: none !important;
                page-break-inside: avoid;
            }

            /* ========== Perfil ========== */
            #perfil {
                text-align: center;
                margin-bottom: 25px;
            }

            #perfil h1 {
                font-size: 32px;
                font-weight: 700;
                margin-top: 10px;
            }

            #perfil h4 {
                color: #0f172a !important;
                font-weight: 500;
                margin-bottom: 12px;
                font-size: 18px;
            }

            #perfil p {
                text-align: justify;
                max-width: 650px;
                margin: 0 auto 15px auto;
                font-size: 14px;
            }

            .perfil-img {
                width: 160px;
                height: 160px;
                object-fit: contain;
                border-radius: 50%;
                border: 4px solid #0f172a;
                background-color: #ffffff;
                padding: 5px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                margin: 0 auto 15px auto;
                display: block;
            }

            /* ========== T√≠tulos de secci√≥n ========== */
            .section-title {
                font-size: 20px;
                font-weight: 600;
                margin-top: 5px;
                margin-bottom: 20px;
                border-left: 5px solid #d4af37;
                padding-left: 12px;
                color: #111827;
                text-shadow: 0 1px 2px rgba(0,0,0,0.05);
            }


            /* ========== Habilidades (Modo normal - Dorado) ========== */
            .skill-chip {
                background: linear-gradient(135deg, #d4af37, #f5e6a8);
                color: #1f2933;
                border: 1px solid #c9a227;
                font-size: 13px;
                font-weight: 600;
                border-radius: 20px;
                padding: 10px 16px;
                margin: 4px 6px 4px 0;
                display: inline-block;
                box-shadow:
                    0 4px 12px rgba(212,175,55,0.35);
                transition:
                    transform 0.25s ease,
                    box-shadow 0.25s ease,
                    background 0.25s ease;
            }

            /* ========== Habilidades (Modo oscuro - Celeste fluorescente) ========== */
            body.dark-mode .skill-chip {
                background: linear-gradient(135deg, #020617, #0f172a) !important;
                color: #00e5ff !important;
                border: 1px solid rgba(0,229,255,0.45);
                box-shadow:
                    0 0 12px rgba(0,229,255,0.45),
                    inset 0 0 6px rgba(0,229,255,0.2);
            }

            .skill-chip:hover {
                transform: translateY(-4px) scale(1.05);
                box-shadow:
                    0 8px 22px rgba(0,0,0,0.25);
            }

            body.dark-mode .skill-chip:hover {
                box-shadow:
                    0 0 25px rgba(0,229,255,0.65),
                    0 0 45px rgba(0,229,255,0.35);
            }

            /* ========== Evitar animaciones ========== */
            * {
                animation: none !important;
                transition: none !important;
            }

            /* ========== Im√°genes ========== */
            img {
                max-width: 100%;
                page-break-inside: avoid;
            }

            /* ======== PDF - Forzar columnas correctas en PDF sin romper Bootstrap ======== */
            .references .col-md-6 {
                width: 48.9% !important;
                display: inline-block !important;
                vertical-align: top !important;
                margin-bottom: 12px !important;
            }

            /* ========== Quitar el gap excesivo del row de Bootstrap ========== */
            .references {
                display: flex !important;
                flex-wrap: wrap !important;
                gap: 1px !important;
            }

            /* ========== Tarjeta de referencia m√°s elegante ========== */
            .ref-card {
                background: #38bdf8 !important;
                border: 1px solid #38bdf8 !important;
                border-radius: 10px !important;
                padding: 12px 15px !important;
                box-shadow: 0 2px 8px rgba(0,0,0,0.06) !important;
                page-break-inside: avoid !important;
            }

           /* ========== Modo obscuro - Referencias (FORZADO) ========== */
            body.dark-mode .reference-item {
                background: rgba(2,6,23,0.88) !important;
                border: 1px solid rgba(0,229,255,0.35) !important;
                color: #7eeeff !important;
                box-shadow:
                    0 12px 35px rgba(0,0,0,0.7),
                    0 0 18px rgba(0,229,255,0.25) !important;
                transition: transform 0.3s ease, box-shadow 0.3s ease;
            }

            body.dark-mode .ref-nombre {
                color: #00e5ff !important;
                text-shadow:
                    0 0 6px rgba(0,229,255,0.8),
                    0 0 12px rgba(0,229,255,0.4);
            }

            body.dark-mode .ref-cargo {
                color: #38f9ff !important;
            }

            body.dark-mode .ref-telefono {
                color: #c7f9ff !important;
            }

            /* ========== Nombre (com√∫n) ========== */
            .ref-nombre {
                display: block !important;
                font-weight: 700 !important;
                font-size: 15px !important;
                margin-bottom: 4px !important;
            }

            /* ========== Cargo debajo del nombre ========== */
            .ref-cargo {
                display: block !important;
                font-size: 13px !important;
                color: #374151 !important;
                margin-bottom: 5px !important;
            }

            /* ========== Tel√©fono ========== */
            .ref-telefono {
                display: block !important;
                font-size: 13px !important;
                margin-bottom: 5px !important;
            }

            /* ========== Descripci√≥n ========== */
            .ref-desc {
                font-size: 12px !important;
                margin: 0 !important;
                color: #4b5563 !important;
            }
            
            /* ================== FIX PDF PROYECTOS ================== */

            #proyectos {
                display: block !important;
                page-break-inside: auto !important;
            }

            #proyectos .row {
                display: block !important;
            }

            #proyectos .col-md-6,
            #proyectos .col-md-4,
            #proyectos .col-sm-6 {
                width: 100% !important;
                display: block !important;
                float: none !important;
                page-break-inside: avoid !important;
            }

            #proyectos .card {
                display: block !important;
                page-break-inside: avoid !important;
                break-inside: avoid !important;
                margin-bottom: 20px !important;
                box-shadow: none !important;
                border: 1px solid #e5e7eb !important;
            }

            #certificados > .card > .section-title {
                display: none !important;
            }

            #certificados > .card {
                padding: 0 !important;
                border: none !important;
                box-shadow: none !important;
            }

            /* ===== CERTIFICADOS A4 REAL ===== */

            @page {
                size: A4;
                margin: 10mm;
            }

            #certificados .cert-card {
                width: 190mm !important;   /* A4 ancho real */
                height: 277mm !important;  /* A4 alto real */
                margin: 0 auto !important;

                display: flex !important;
                flex-direction: column !important;
                justify-content: center !important;
                align-items: center !important;

                page-break-after: always !important;
                break-after: page !important;

                box-shadow: none !important;
                border: none !important;
            }

            /* Imagen ocupa casi toda la hoja */
            #certificados .cert-card img {
                width: 100% !important;
                height: 245mm !important;
                object-fit: contain !important;
                margin: 0 !important;
            }

            /* Evita hoja en blanco final */
            #certificados .cert-card:last-child {
                page-break-after: auto !important;
                break-after: auto !important;
            }

        }
        
        .reference-item {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 18px 20px;
            margin-bottom: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            transition: 0.2s ease;
        }

        .reference-item:hover {
            box-shadow: 0 6px 14px rgba(0,0,0,0.08);
        }

        .reference-item h4 {
            font-size: 16px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 4px;
        }

        .reference-item .cargo {
            font-size: 14px;
            font-weight: 500;
            color: #0f172a;
            margin-bottom: 2px;
        }

        .reference-item .telefono {
            font-size: 14px;
            color: #374151;
        }

        .ref-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .ref-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.15);
        }

        body.dark-mode .ref-card:hover {
            box-shadow: 0 12px 30px rgba(96,165,250,0.15);
        }

        /* ====== FIX DEFINITIVO: Referencias en modo oscuro (no m√°s blanco) ====== */
        body.dark-mode #referencias .reference-item,
        body.dark-mode #referencias .ref-card,
        body.dark-mode .references .reference-item,
        body.dark-mode .references .ref-card {
            background: rgba(2, 6, 23, 0.88) !important;
            border: 1px solid rgba(0, 229, 255, 0.35) !important;
            color: #7eeeff !important;
            box-shadow:
                0 12px 35px rgba(0,0,0,0.7),
                0 0 18px rgba(0,229,255,0.25) !important;
        }

        /* Texto dentro de la tarjeta */
        body.dark-mode #referencias .ref-nombre,
        body.dark-mode .references .ref-nombre {
            color: #00e5ff !important;
            text-shadow: 0 0 6px rgba(0,229,255,0.8), 0 0 12px rgba(0,229,255,0.4);
        }

        body.dark-mode #referencias .ref-cargo,
        body.dark-mode .references .ref-cargo {
            color: #38f9ff !important;
        }

        body.dark-mode #referencias .ref-telefono,
        body.dark-mode .references .ref-telefono,
        body.dark-mode #referencias .phone,
        body.dark-mode .references .phone {
            color: #c7f9ff !important;
        }

        /* Hover */
        body.dark-mode #referencias .reference-item:hover,
        body.dark-mode .references .reference-item:hover {
            transform: translateY(-6px);
            box-shadow:
                0 0 30px rgba(0,229,255,0.55),
                0 0 60px rgba(0,229,255,0.25) !important;
        }

        /* ====== FIX DEFINITIVO: Skill chips Dorado (normal) / Celeste fl√∫or (dark) ====== */

        /* Modo normal (Dorado) */
        body:not(.dark-mode) #habilidades .skill-chip,
        body:not(.dark-mode) .skill-chip {
            background: linear-gradient(135deg, #d4af37, #f5e6a8) !important;
            color: #111827 !important;
            border: 1px solid #c9a227 !important;
            box-shadow: 0 4px 12px rgba(212,175,55,0.35) !important;
            font-weight: 700 !important;
        }

        /* Modo oscuro (Celeste fluorescente) */
        body.dark-mode #habilidades .skill-chip,
        body.dark-mode .skill-chip {
            background: linear-gradient(135deg, #020617, #0f172a) !important;
            color: #00e5ff !important;
            border: 1px solid rgba(0,229,255,0.55) !important;
            box-shadow:
                0 0 14px rgba(0,229,255,0.5),
                inset 0 0 8px rgba(0,229,255,0.2) !important;
            text-shadow: 0 0 8px rgba(0,229,255,0.35) !important;
        }

        /* Hover */
        body:not(.dark-mode) #habilidades .skill-chip:hover,
        body:not(.dark-mode) .skill-chip:hover {
            transform: translateY(-3px) scale(1.04);
            box-shadow: 0 10px 22px rgba(212,175,55,0.45) !important;
        }

        body.dark-mode #habilidades .skill-chip:hover,
        body.dark-mode .skill-chip:hover {
            transform: translateY(-3px) scale(1.04);
            box-shadow:
                0 0 26px rgba(0,229,255,0.7),
                0 0 55px rgba(0,229,255,0.35) !important;
        }

    </style>
</head>

<body>

<!-- NAVBAR -->
<nav class = "navbar navbar-expand-lg navbar-light bg-white shadow-sm fixed-top">
    <div class = "container">
        <a class = "navbar-brand fw-bold" href = "#"> Hoja de Vida Automatica </a>

        <button class = "navbar-toggler" type = "button" data-bs-toggle = "collapse" data-bs-target = "#navbarNav">
            <span class = "navbar-toggler-icon"> </span>
        </button>

        <div class = "collapse navbar-collapse" id = "navbarNav">
            <ul class = "navbar-nav ms-auto">

                <li class = "nav-item">
                    <a class = "nav-link" href = "#perfil"> Perfil </a>
                </li>

                <li class = "nav-item">
                    <a class = "nav-link" href = "#educacion"> Educaci√≥n </a>
                </li>

                <li class = "nav-item">
                    <a class = "nav-link" href = "#experiencia"> Experiencia Laboral </a>
                </li>

                <li class = "nav-item">
                    <a class = "nav-link" href = "#habilidades"> Habilidades </a>
                </li>

                <li class = "nav-item">
                    <a class = "nav-link" href = "#certificados"> Certificados </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="#reconocimientos">Reconocimientos</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="#cursos">Cursos</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="#productos-academicos">Productos Acad√©micos</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="#productos-laborales">Productos Laborales</a>
                </li>

                <li class = "nav-item">
                    <a class = "nav-link" href = "#proyectos"> Proyectos </a>
                </li>

                <li class = "nav-item">
                    <a class="nav-link" href="#referencias">Referencias</a>
                </li>

                <button class = "btn btn-success ms-2" data-bs-toggle="modal" data-bs-target="#pdfOptionsModal">
                    üìÑ Descargar Hoja de Vida
                </button>

                <li class = "nav-item ms-3">
                    <button class = "btn btn-outline" onclick = "toggleDarkMode ()" id = "darkBtn">
                        üåô
                    </button>
                </li>

            </ul>
        </div> 
    </div>
</nav>

<!-- CONTENIDO -->
<div class = "container py-5">

    <!-- PERFIL -->
    <section id = "perfil" class = "mb-4 reveal">
        <div class = "card shadow p-4">
            <div class = "row align-items-center">

                <div class = "col-md-3 text-center">
                    {% if perfil.foto %}
                        <img src = "{{ perfil.foto.url }}" class = "perfil-img mb-3">
                    {% endif %}
                </div>

                <div class = "col-md-9"> 
                    <h1 class = "mb-0"> {{ perfil.nnombres }} {{ perfil.apellidos }} </h1>
                    <h4 class = "text-primary"> {{ perfil.profesion }} </h4>
                    <p class = "mt-3"> {{ perfil.descripcion|linebreaksbr }} </p>

                    <p class = "mb-1"> Correo: üìß {{ perfil.email }} </p>
                    <p class = "mb-1"> Ubicacion: üìç {{ perfil.ubicacion }} </p>
                    <p class = "mb-1"> Tel√©fono: üì± {{ perfil.telefono }} </p>

                    <div class = "d-flex align-items-center gap-3 mt-2">
    
                    <a href = "{{ perfil.linkedin }}" target = "_blank" class = "text-decoration-none d-flex align-items-center">
                        <i class = "bi bi-linkedin me-1"> </i> {{ perfil.nnombres }} {{ perfil.apellidos }}
                    </a>

                    <a href = "{{ perfil.github }}" target = "_blank" class = "text-decoration-none d-flex align-items-center">
                        <i class = "bi bi-github me-1"> </i> {{ perfil.nnombres }} {{ perfil.apellidos }}
                    </a>

                </div>

            </div>
        </div>
    </section>

    <!-- DATOS PERSONALES -->
    <section id="datos-personales" class="mb-4 reveal">
        <div class="card shadow p-4">
            <h3 class="section-title">ü™™ Datos Personales</h3>

            <div class="row">
                <div class="col-md-6">
                    <p><strong>C√©dula:</strong> {{ perfil.cedula }}</p>
                    <p><strong>Sexo:</strong> {{ perfil.sexo }}</p>
                    <p><strong>Estado civil:</strong> {{ perfil.estado_civil }}</p>

                    {% if perfil.licencia_de_conducir %}
                    <p><strong>Licencia:</strong> {{ perfil.licencia_de_conducir }}</p>
                    {% endif %}
                </div>

                <div class="col-md-6">
                    <p><strong>Nacionalidad:</strong> {{ perfil.nacionalidad }}</p>
                    <p><strong>Lugar de nacimiento:</strong> {{ perfil.lugar_de_nacimiento }}</p>
                    <p><strong>Fecha de nacimiento:</strong> {{ perfil.fecha_de_nacimiento }}</p>
                </div>
            </div>
        </div>
    </section>


    <!-- DIRECCIONES Y CONTACTO -->
    <section id="contacto" class="mb-4 reveal">
        <div class="card shadow p-4">
            <h3 class="section-title">üìç Contacto</h3>

            <p><strong>Tel√©fono convencional:</strong> {{ perfil.telefono_convencional }}</p>
            <p><strong>Direcci√≥n domiciliaria:</strong> {{ perfil.direccion_domiciliaria }}</p>
            <p><strong>Direcci√≥n de trabajo:</strong> {{ perfil.direccion_de_trabajo }}</p>

            {% if perfil.sitio_web %}
            <p>
                <strong>Sitio web:</strong>
                <a href="{{ perfil.sitio_web }}" target="_blank">
                    {{ perfil.sitio_web }}
                </a>
            </p>
            {% endif %}
        </div>
    </section>

    <!-- EDUCACION -->
    <section id = "educacion" class = "mb-4 reveal">
        <div class = "card shadow p-4">
            <h3 class = "section-title"> üéì Educaci√≥n </h3>

            {% for edu in educaciones %}
                <div class = "mb-3">
                    
                    <strong> 
                        {{ edu.titulo }} 
                    </strong>

                    <br>
                        {{ edu.institucion }} 
                    <br>

                    <small class = "text-muted">
                        {{ edu.fecha_inicio }} - {{ edu.fecha_fin|default:"Actualidad" }}
                    </small>

                </div>
            {% endfor %}
            
        </div>
    </section>

    <!-- EXPERIENCIA -->
    <section id = "experiencia" class = "mb-4 reveal">
        <div class = "card shadow p-4">
            <h3 class = "section-title"> üíº Experiencia Laboral </h3>

            {% for exp in experiencias %}
                <div class = "mb-3">

                    <strong> 
                        {{ exp.cargo }} 
                    </strong> - {{ exp.empresa }} <br>

                    <small class = "text-muted">
                        {{ exp.fecha_inicio }} - {{ exp.fecha_fin|default:"Actualidad" }}
                    </small>

                    <p class = "mt-2"> {{ exp.descripcion|linebreaksbr }} </p>

                     <!-- Lugar -->
                    {% if exp.lugar_de_la_empresa %}
                        <small class="text-muted">
                            {{ exp.lugar_de_la_empresa }}
                        </small>
                        <br>
                    {% endif %}

                    <!-- Contacto empresarial -->
                    {% if exp.nombre_del_contacto_empresarial or exp.telefono_del_contacto_empresarial %}
                    <p class="mb-1">
                        <strong>Contacto:</strong>
                        {{ exp.nombre_del_contacto_empresarial }}
                        {% if exp.telefono_del_contacto_empresarial %}
                            - {{ exp.telefono_del_contacto_empresarial }}
                        {% endif %}
                    </p>
                    {% endif %}

                     <!-- Email empresa -->
                    {% if exp.email_de_la_empresa %}
                    <p class="mb-1">
                        üìß {{ exp.email_de_la_empresa }}
                    </p>
                    {% endif %}

                    <!-- Sitio web empresa -->
                    {% if exp.sitio_web_de_la_empresa %}
                    <p class="mb-1">
                        üåê <a href="{{ exp.sitio_web_de_la_empresa }}" target="_blank">
                            {{ exp.sitio_web_de_la_empresa }}
                        </a>
                    </p>
                    {% endif %}

                     <!-- Certificado -->
                    {% if exp.ruta_del_certificado %}
                    <a href="{{ exp.ruta_del_certificado.url }}" target="_blank" class="btn btn-sm btn-outline-secondary mt-2">
                        üìé Ver certificado
                    </a>
                    {% endif %}

                </div>
            {% endfor %}

        </div>
    </section>

    <!-- HABILIDADES -->
    <section id = "habilidades" class = "mb-4 reveal">
        <div class = "card shadow p-4">
            <h3 class = "section-title"> üß† Habilidades </h3>

            <div class = "d-flex flex-wrap gap-2">
                {% for hab in habilidades %}

                    <div class = "skill-chip">
                        {{ hab.nombre }}
                    </div>

                {% endfor %}
            </div>
            
        </div>
    </section>

    <!-- CERTIFICADOS -->
    <section id="certificados" class="mb-4 reveal">
        <div class="card shadow p-4">
            <h3 class="section-title"> üìú Certificados </h3>

            <div class="row g-4">

                {% for cert in certificados %}
                <div class="col-md-4 col-sm-6">
                    <div class="card cert-card h-100">

                        <!-- PREVIEW -->
                        {% if cert.imagen %}
                            <img
                                src="{{ cert.imagen.url }}"
                                alt="{{ cert.titulo }}"
                                loading="lazy"
                            >
                        {% else %}
                            <div class="d-flex align-items-center justify-content-center text-muted"
                                style="height:200px; background:#f8fafc;">
                                <div class="text-center">
                                    <i class="bi bi-file-earmark-pdf" style="font-size:46px;"></i>
                                    <p class="mb-0 mt-2">Sin vista previa</p>
                                </div>
                            </div>
                        {% endif %}

                        <!-- INFO -->
                        <div class="card-body text-center">
                            <p class="cert-title mb-1 fw-semibold">
                                {{ cert.titulo }}
                            </p>

                            <small class="text-muted">
                                {{ cert.institucion }}
                            </small>

                            {% if cert.drive_file_id or cert.drive_share_url %}
                            <div class="mt-3 d-flex justify-content-center gap-2">

                                <!-- VER (abre el visor de Drive) -->
                                <a
                                    href="{% if cert.drive_file_id %}https://drive.google.com/file/d/{{ cert.drive_file_id }}/view?usp=sharing{% else %}{{ cert.drive_share_url }}{% endif %}"
                                    target="_blank"
                                    class="btn btn-sm btn-outline-danger"
                                >
                                    üëÅÔ∏è Ver PDF
                                </a>

                                <!-- DESCARGAR (descarga directa si hay drive_file_id) -->
                                <a
                                    href="{% if cert.drive_file_id %}https://drive.google.com/uc?export=download&id={{ cert.drive_file_id }}{% else %}{{ cert.drive_share_url }}{% endif %}"
                                    target="_blank"
                                    class="btn btn-sm btn-outline-success"
                                >
                                    ‚¨áÔ∏è Descargar
                                </a>

                            </div>
                            {% else %}
                            <p class="text-muted mt-3">PDF no disponible</p>
                            {% endif %}

                        </div>

                    </div>
                </div>
                {% empty %}
                    <p class="text-muted">
                        No hay certificados cargados.
                    </p>
                {% endfor %}

            </div>
        </div>
    </section>

    <!-- RECONOCIMIENTOS -->
    <section id="reconocimientos" class="mb-4 reveal">
        <div class="card shadow p-4">
            <h3 class="section-title">üèÖ Reconocimientos</h3>

            {% for r in reconocimientos %}
            <div class="mb-3">
                <strong>{{ r.tipo_reconocimiento }}</strong>
                {% if r.fecha_reconocimiento %}
                <small class="text-muted"> - {{ r.fecha_reconocimiento }}</small>
                {% endif %}

                {% if r.entidad_patrocinadora %}
                <div class="text-muted">{{ r.entidad_patrocinadora }}</div>
                {% endif %}

                {% if r.descripcion_reconocimiento %}
                <p class="mt-2">{{ r.descripcion_reconocimiento|linebreaksbr }}</p>
                {% endif %}

                {% if r.ruta_certificado %}
                <a class="btn btn-sm btn-outline-secondary mt-1" target="_blank" href="{{ r.ruta_certificado.url }}">
                    üìé Ver certificado
                </a>
                {% endif %}
            </div>
            {% empty %}
            <p class="text-muted">No hay reconocimientos cargados.</p>
            {% endfor %}
        </div>
    </section>

    <!-- CURSOS REALIZADOS -->
    <section id="cursos" class="mb-4 reveal">
        <div class="card shadow p-4">
            <h3 class="section-title">üìö Cursos Realizados</h3>

            {% for c in cursos_realizados %}
            <div class="mb-3">
                <strong>{{ c.nombre_curso }}</strong>
                <br>
                <small class="text-muted">
                {{ c.fecha_inicio|default:"" }}{% if c.fecha_inicio or c.fecha_fin %} - {% endif %}{{ c.fecha_fin|default:"" }}
                {% if c.total_horas %} | {{ c.total_horas }} horas{% endif %}
                </small>

                {% if c.entidad_patrocinadora %}
                <div class="text-muted">{{ c.entidad_patrocinadora }}</div>
                {% endif %}

                {% if c.descripcion_curso %}
                <p class="mt-2">{{ c.descripcion_curso|linebreaksbr }}</p>
                {% endif %}

                {% if c.ruta_certificado %}
                <a class="btn btn-sm btn-outline-secondary mt-1" target="_blank" href="{{ c.ruta_certificado.url }}">
                    üìé Ver certificado
                </a>
                {% endif %}
            </div>
            {% empty %}
            <p class="text-muted">No hay cursos cargados.</p>
            {% endfor %}
        </div>
    </section>

    <!-- PRODUCTOS ACAD√âMICOS -->
    <section id="productos-academicos" class="mb-4 reveal">
        <div class="card shadow p-4">
            <h3 class="section-title">üéì Productos Acad√©micos</h3>

            {% for p in productos_academicos %}
            <div class="mb-3">
                <strong>{{ p.nombre_recurso }}</strong>
                {% if p.clasificador %}
                <small class="text-muted"> - {{ p.clasificador }}</small>
                {% endif %}
                {% if p.descripcion %}
                <p class="mt-2">{{ p.descripcion|linebreaksbr }}</p>
                {% endif %}
            </div>
            {% empty %}
            <p class="text-muted">No hay productos acad√©micos cargados.</p>
            {% endfor %}
        </div>
    </section>

    <!-- PRODUCTOS LABORALES -->
    <section id="productos-laborales" class="mb-4 reveal">
        <div class="card shadow p-4">
            <h3 class="section-title">üß∞ Productos Laborales</h3>

            {% for p in productos_laborales %}
            <div class="mb-3">
                <strong>{{ p.nombre_producto }}</strong>
                {% if p.fecha_producto %}
                <small class="text-muted"> - {{ p.fecha_producto }}</small>
                {% endif %}
                {% if p.descripcion %}
                <p class="mt-2">{{ p.descripcion|linebreaksbr }}</p>
                {% endif %}
            </div>
            {% empty %}
            <p class="text-muted">No hay productos laborales cargados.</p>
            {% endfor %}
        </div>
    </section>

    <!-- PROYECTOS -->
    <section id = "proyectos" class = "mb-4 reveal">
        <div class = "card shadow p-4">
            <h3 class = "section-title"> üöÄ Proyectos </h3>

            <div class = "row g-4">
                {% for proy in proyectos %}

                <div class = "col-md-6">
                    <div class = "card h-100 p-3 shadow-sm">

                        <h5 class = "fw-bold"> {{ proy.nombre }} </h5>
                        <p> {{ proy.descripcion }} </p>

                        <p class = "mb-2">
                            <strong> Tecnolog√≠as: </strong> {{ proy.tecnologias }}
                        </p>

                        <div class = "d-flex gap-2">
                            {% if proy.github %}
                            <a href = "{{ proy.github }}" target = "_blank" class = "btn btn-outline-primary btn-sm">
                                GitHub
                            </a>
                            {% endif %}

                            {% if proy.demo %}
                            <a href = "{{ proy.demo }}" target = "_blank" class = "btn btn-outline-success btn-sm">
                                Demo
                            </a>
                            {% endif %}
                        </div>

                    </div>
                </div>

                {% endfor %}
            </div>

        </div>
    </section>

    <!-- VENTA GARAGE -->
    <section id="venta-garage" class="mb-4 reveal">
        <div class="card shadow p-4">
            <h3 class="section-title"> üè∑Ô∏è Venta Garage </h3>

            <div class="row g-4">
                {% for item in ventas_garage %}
                    {% if item.activar_para_que_se_vea_en_front %}
                    <div class="col-md-4 col-sm-6">

                        <div class="card h-100 shadow-sm">

                            <!-- Imagen del producto -->
                            {% if item.imagen_del_producto %}
                            <img src="{{ item.imagen_del_producto.url }}"
                                class="card-img-top"
                                alt="{{ item.nombre_del_producto }}"
                                style="height: 200px; object-fit: cover;">
                            {% endif %}

                            <div class="card-body text-center">

                                <!-- Nombre -->
                                <h5 class="fw-bold">
                                    {{ item.nombre_del_producto }}
                                </h5>

                               <!-- Estado -->
                                <span class="badge 
                                    {% if item.estado_del_producto == 'Regular' %}
                                        bg-danger
                                    {% elif item.estado_del_producto == 'Excelente' %}
                                        bg-success
                                    {% else %}
                                        bg-secondary
                                    {% endif %}
                                    mb-2">
                                    Estado: {{ item.estado_del_producto }}
                                </span>
                                <!-- Precio -->
                                <p class="fs-5 fw-semibold mt-2">
                                    $ {{ item.valor_del_bien }}
                                </p>

                            </div>

                        </div>

                    </div>
                    {% endif %}
                {% empty %}
                    <p class="text-muted">
                        No hay productos disponibles en venta.
                    </p>
                {% endfor %}
            </div>

        </div>
    </section>

    <!-- REFERENCIAS -->
    <section id = "referencias" class = "mb-4 reveal">
        <div class = "card shadow p-4">
            <h3 class = "section-title"> üë• Referencias </h3>

            {% if referencias %}
                <div class="row g-4 references">  
                    {% for ref in referencias %}

                    <div class="col-md-6 col-sm-12">
                        <div class="ref-card p-3 reference-item">

                            <strong>{{ ref.nombre }}</strong><br>
                            <span>{{ ref.cargo }} - {{ ref.empresa }}</span><br>

                            <!-- Tel√©fono -->
                            <span class="phone">üìû {{ ref.telefono }}</span><br>

                            <p class="mt-2">{{ ref.descripcion }}</p>

                        </div>
                    </div>

                    {% endfor %}
                </div>

            {% else %}

                <p class = "text-muted"> 
                    A√∫n no se han agregado referencias laborales. 
                </p>

            {% endif %}

        </div>
    </section>

</div>

<script>
    function openCertFile(url, title, isPdf) {
        if (isPdf) {
            // PDF: abrir en pesta√±a nueva
            window.open(url, "_blank");
            return;
        }

        // Imagen: mostrar en modal
        document.getElementById("certModalImg").src = url;
        document.getElementById("certModalTitle").innerText = title;
    }
</script>

<!-- Bootstrap JS -->
<script src = "https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"> </script>

<script>
    const btn = document.getElementById ("darkBtn");

    function applyDarkMode (isDark) {
        document.body.classList.toggle ("dark-mode", isDark);
        btn.innerText = isDark ? "‚òÄÔ∏è" : "üåô";
    }

    function toggleDarkMode () {
        const isDark = !document.body.classList.contains ("dark-mode");
        localStorage.setItem ("darkMode", isDark);
        applyDarkMode (isDark);
    }

    // Al cargar la p√°gina
    const savedMode = localStorage.getItem ("darkMode") === "true";
    applyDarkMode (savedMode);

    // üî• ESCUCHAR CAMBIOS ENTRE P√ÅGINAS
    window.addEventListener ("storage", (event) => {
        if (event.key === "darkMode") {
            applyDarkMode (event.newValue === "true");
        }
    });

</script>

<script>
    function openCertModal (img, title) {
        document.getElementById ("certModalImg").src = img;
        document.getElementById ("certModalTitle").innerText = title;
    }
</script>

<!-- MODAL CERTIFICADO -->
<div class = "modal fade" id = "certModal" tabindex = "-1">
    <div class = "modal-dialog modal-dialog-centered modal-lg">
        <div class = "modal-content">

            <div class = "modal-header">
                <h5 class = "modal-title" id = "certModalTitle"> </h5>
                <button type = "button" class = "btn-close" data-bs-dismiss = "modal"> </button>
            </div>

            <div class = "modal-body text-center">
                <img id = "certModalImg" src = "" class = "img-fluid rounded">
            </div>

        </div>
    </div>
</div>

<script>
    const reveals = document.querySelectorAll (".reveal");

    const observer = new IntersectionObserver (
        entries => {
            entries.forEach (entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add ("active");
                    observer.unobserve(entry.target);
                }
            });
        },

        {
            threshold: 0.15
        }
    );

    reveals.forEach (section => {
        observer.observe (section);
    });

</script>

<script>
function generatePDF() {
    const wasDark = document.body.classList.contains("dark-mode");
    if (wasDark) document.body.classList.remove("dark-mode");

    const checkboxes = document.querySelectorAll(".pdf-option");
    const toHide = [];

    checkboxes.forEach(cb => {
        const selector = cb.value;
        const element = document.querySelector(selector);

        if (!cb.checked && element) {
            element.classList.add("pdf-hide");   // üî• CLAVE
            toHide.push(element);
        }
    });

    const modal = bootstrap.Modal.getInstance(
        document.getElementById('pdfOptionsModal')
    );
    modal.hide();

    setTimeout(() => {
        window.print();

        // Restaurar
        toHide.forEach(el => el.classList.remove("pdf-hide"));

        if (wasDark) document.body.classList.add("dark-mode");
    }, 200);
}
</script>

<!-- MODAL PARA SELECCIONAR SECCIONES -->
<div class="modal fade" id="pdfOptionsModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title">Seleccionar contenido del PDF</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body">
                <p class="mb-2">Elige qu√© secciones deseas incluir en tu PDF:</p>

                <div class="form-check">
                    <input class="form-check-input pdf-option" type="checkbox" value="#perfil" checked>
                    <label class="form-check-label">Perfil</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input pdf-option" type="checkbox" value="#educacion" checked>
                    <label class="form-check-label">Educaci√≥n</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input pdf-option" type="checkbox" value="#experiencia" checked>
                    <label class="form-check-label">Experiencia Laboral</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input pdf-option" type="checkbox" value="#habilidades" checked>
                    <label class="form-check-label">Habilidades</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input pdf-option" type="checkbox" value="#certificados" checked>
                    <label class="form-check-label">Certificados</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input pdf-option" type="checkbox" value="#proyectos" checked>
                    <label class="form-check-label">Proyectos</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input pdf-option" type="checkbox" value="#referencias" checked>
                    <label class="form-check-label">Referencias</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input pdf-option" type="checkbox" value="#datos-personales" checked>
                    <label class="form-check-label">Datos personales</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input pdf-option" type="checkbox" value="#contacto" checked>
                    <label class="form-check-label">Contacto y direcciones</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input pdf-option" type="checkbox" value="#licencia" checked>
                    <label class="form-check-label">Licencia de conducir</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input pdf-option" type="checkbox" value="#reconocimientos" checked>
                    <label class="form-check-label">Reconocimientos</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input pdf-option" type="checkbox" value="#cursos" checked>
                    <label class="form-check-label">Cursos Realizados</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input pdf-option" type="checkbox" value="#productos-academicos" checked>
                    <label class="form-check-label">Productos Acad√©micos</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input pdf-option" type="checkbox" value="#productos-laborales" checked>
                    <label class="form-check-label">Productos Laborales</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input pdf-option" type="checkbox" value="#venta-garage" checked>
                    <label class="form-check-label">Venta Garage</label>
                </div>

            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button class="btn btn-primary" onclick="generatePDF()">Generar PDF</button>
            </div>

        </div>
    </div>
</div>

</body>

</html>